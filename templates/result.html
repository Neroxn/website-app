{% extends "base.html" %}
{% block title %} {% endblock %}

{% block head %}
{{ super() }}
<link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/navbar.css') }}">
<link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/result.css') }}">

{% if graphSelected %}
  {{ js_resources|indent(4)|safe }}
  {{ css_resources|indent(4)|safe }}
  {{ plot_script|indent(4)|safe }}
{% endif %}

{% endblock %}



{% block page_content %}
<div class="container mt-3">
  <h2>Result of the test data.</h2>
<div class="scrollmenu">
  <table>
      <tr>
          {% for col in column_names %}
          <th>{{col}}</th>
          {% endfor %}
      </tr>
      {% for row in row_data %}
      <tr>
          {% for col, row_ in zip(column_names, row) %}
          {% if col == link_column %}
          <td>
              <button type="submit" value={{ row_ }} name="person_id" form="patient_form" class="patient_button">
                  {{ row_ }}
              </button>
          </td>
          {% else %}
          <td>{{row_}}</td>
          {% endif %}
          {% endfor %}
      </tr>
      {% endfor %}
  
  </table>
</div>

<a class="btn btn-success mt-2" href="{{ url_for('download_csv',path = path) }}">Download test results as csv file.</a>

<hr/>
<h2>Loss metrics:</h2>
  <table class = "table">
    <thead>
      <tr>
        <th scope="col">#</th>
        {% for parameter in parameters %}
        <th scope="col">{{ parameter }}</th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      <tr>
    {% if model_scores %}
      <th scope = "row"> Model Scores </th>
        {% for model_score in model_scores %}
          <td>{{ model_score }}</td>
        {% endfor %}  
    {% endif %}
  </tr>

    <tr>
    {% if mse_errors %}
      <th scope = "row">MSE</th>
        {% for mse in mse_errors %}
          <td>{{ mse }}</td>
        {% endfor %}  
    {% endif %}
  </tr>
  <tr>
    {% if mae_errors %}
      <th scope = "row">MAE</th>
      {% for mae in mae_errors %}
        <td>{{ mae }}</td>
      {% endfor %}  
    {% endif %}
  </tr>
  <tr>
    {% if log_errors %}
      <th scope = "row">Log Error</th>
        {% for log_error in log_errors %}
        <td>{{ log_error }}</td>
        {% endfor %}  
    {% endif %}
  </tr>
  <tr>
    {% if f1_scores %}
      <th scope = "row">F1 Score</th>
        {% for f1_score in f1_scores %}
        <td>{{ f1_score }}</td>
        {% endfor %}  
    {% endif %}
  </tr>
</tbody>
</table>
<div class="container mt-3">
  {% if graphSelected %}
    <hr/>
    <div style="display: flex; justify-content: center;">
      {{ plot_div|indent(4)|safe }}
    </div>
  {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static',filename='js/bar_plot.js') }}"></script>
{% endblock %}
